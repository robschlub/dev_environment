$title-height: 5;
$title-font-size: 2.5;
$np_button-width: 3;
$np_button-height-portrait: 8;
$np_button-height-landscape: 8;
$np_button-vspace: 4;
$np_button-hspace: 4;
$text-margin: 4;
$goto_button-width: 9;
// $goto_button-min-width: 50px;
$goto_button-height: 4;
$goto_button-font-size: 1.4;

$top_margin-no_navbar: 20px;
$top_margin-with_navbar: 70px;
$bottom_margin: 50px;
$side-margin: 10px;
$diagram_ratio: 1.5;

@media (min-aspect-ratio: 1/100) {
  :root {
    --lesson__container-width: 90vw;
    --lesson__top-margin: 20px;
    --lesson__title-font-size: calc(#{$title-font-size} * 1vw);
    --lesson__title-height: calc(#{$title-height} * 1vw);
    --lesson__np_button-width: calc(#{$np_button-width} * 1vw);
    --lesson__np_button-height: calc(#{$np_button-height-portrait} * 1vw);
    --lesson__np_button-vspace: calc(#{$np_button-vspace} * 1vw);
    --lesson__np_button-hspace: calc(#{$np_button-hspace} * 1vw);
    // --lesson__text-margin: calc(#{$text-margin} * 1vw);
    --lesson__text-margin: 1em;
    --lesson__goto_button-width: calc(#{$goto_button-width} * 1vw * 1.5);
    --lesson__goto_button-height: calc(#{$goto_button-height} * 1vw * 1.5);
    --lesson__goto_button-font-size: calc(#{$goto_button-font-size} * 1vw);
  }
}

@media (min-aspect-ratio: 1/1) {
  :root {
    --lesson__container-width: calc(90vw - #{$side-margin} * 2);
    --lesson__np_button-height: calc(#{$np_button-height-landscape} * 1vw);
    --lesson__goto_button-width: calc(#{$goto_button-width} * 1vw);
    --lesson__goto_button-height: calc(#{$goto_button-height} * 1vw);
  }
}

@include media-breakpoint-up(md) {
  :root {
    --lesson__top-margin: 70px;
  }
}

// @media (min-width: #{$xxl}) {
//   :root {
//     --lesson__container-width: calc(#{$xxl} * 0.9);
//     --lesson__title-font-size: calc(#{$title-font-size} / 100 * #{$xxl} * 1.2);
//     --lesson__title-height: calc(#{$title-height} / 100 * #{$xxl});
//     --lesson__np_button-width: calc(#{$np_button-width} / 100 * #{$xxl});
//     --lesson__np_button-height: calc(#{$np_button-height-landscape} / 100 * #{$xxl});
//     --lesson__np_button-vspace: calc(#{$np_button-vspace} / 100 * #{$xxl});
//     --lesson__np_button-hspace: calc(#{$np_button-hspace} / 100 * #{$xxl});
//     // --lesson__text-margin: calc(#{$text-margin} / 100 * #{$xxl});
//     --lesson__text-margin: 1em;
//     --lesson__goto_button-width: calc(#{$goto_button-width} / 100 * #{$xxl});
//     --lesson__goto_button-height: calc(#{$goto_button-height} / 100 * #{$xxl});
//     --lesson__goto_button-font-size: calc(#{$goto_button-font-size} / 100 * #{$xxl});
//   }
// }

@media (min-aspect-ratio: 2/1) and (max-height: 500px) {
  :root {
    --lesson__goto_button-height: 10vh;
    --lesson__goto_button-width: 20vh;
    --lesson__np_button-height: 20vh;
    --lesson__goto_button-font-size: 3vh;
  }
}

:root {
  --lesson__content-width: var(--lesson__container-width);
  --lesson__content-height: calc(var(--lesson__content-width) / #{$diagram_ratio});
  --lesson__container-height: calc(var(--lesson__content-height) + var(--lesson__np_button-vspace) + var(--lesson__np_button-height));
  --lesson__diagram-font-size: 1;
}

@mixin lesson_vars() {
  @each $var, $value in $_lesson_vars {
    @if type-of($value) == "map" {
      @each $subvar, $subvalue in $value {
        @if type-of($subvalue) == "map" {
          @each $subsubvar, $subsubvalue in $subvalue {
            --lessonvars-#{$var}-#{$subvar}-#{$subsubvar}: #{$subsubvalue};
          }
        }

        @else {
          --lessonvars-#{$var}-#{$subvar}: #{$subvalue};
        }
      }
    }

    @else {
      --lessonvars-#{$var}: #{$value};
    }
  }
}

.lesson__container {
  position: relative;
  margin-left: auto;
  margin-right: auto;
  width: var(--lesson__container-width);
  height: var(--lesson__container-height);
  margin-bottom: $bottom_margin;
}

.lesson__widescreen_backdrop {
  background-color: color(diagram, 'background');
}

.multipage_diagram {
  width: var(--lesson__content-width);
  height: var(--lesson__content-height);
}

.lesson__text {
  // display: inline-block;
  // background-color: rgba($color_diagram, 0.4);
  margin-left: var(--lesson__text-margin);
  margin-right: var(--lesson__text-margin);
  // margin-bottom: var(--lesson__text-margin);
  margin-top: var(--lesson__text-margin);
  height: calc(100% - var(--lesson__text-margin) * 2);
}

.lesson__text ul {
  margin-left: calc(var(--lesson__text-margin) * 1);
  margin-right: calc(var(--lesson__text-margin) * 1);
  padding-left: calc(var(--lesson__diagram-font-size) * 0.8);
  padding-right: calc(var(--lesson__diagram-font-size) * 0.8);
}

.lesson__small_text {
  font-size: calc(var(--lesson__diagram-font-size) * 0.8);
}

.lesson__text p {
  // display: inline-block;
  // padding-left: calc(var(--lesson__diagram-font-size) * 0.2);
  // padding-right: calc(var(--lesson__diagram-font-size) * 0.2);
  // clear: both;
  // float: left;
  color: color(diagram, 'text-base');
  margin-left: calc(var(--lesson__text-margin) * 1);
  margin-right: calc(var(--lesson__text-margin) * 1);
  // margin-top: 6%;
  // margin-bottom: 1em;
  margin-bottom: 4%;
  margin-top: 0;
}

.lesson__text p:first-child {
  margin-top: 0;
  margin-top: var(--lesson__text-margin);
}

.lesson__text p:last-child {
  // margin-bottom: var(--lesson__text-margin);
}

.lesson__title {
  font-size: var(--lesson__title-font-size);
  color: color(lesson, 'text-title');
  height: var(--lesson__title-height);
  text-align: center;
  margin-top: var(--lesson__top-margin);
  margin-bottom: 0;
  padding-bottom: 0;
  font-weight: bold;
}

.btn-multi-page-lesson {
  position: absolute;
  border-style: none;
  border: 0;
  padding: 0;
  background-color: color(diagram, 'background');
  top: calc(100% - var(--lesson__np_button-height));
  width: 0;
  height: 0;
  border-top: calc(var(--lesson__np_button-height) / 2) solid transparent;
  border-bottom: calc(var(--lesson__np_button-height) / 2) solid transparent;
}

#lesson__button-previous {
  left: 0;
  // border-right: var(--lesson__np_button-width) solid color(navbar, 'button');
}

#lesson__button-next {
  right: 0;
  // border-left: var(--lesson__np_button-width) solid color(navbar, 'button');
}

// #lesson__button-next:hover {
//   border-left: var(--lesson__np_button-width) solid lighten(color(navbar, 'button'), 20);
// }

// #lesson__button-previous:hover {
//   border-right: var(--lesson__np_button-width) solid lighten(color(navbar, 'button'), 20);
// }


.lesson__button-next-enabled {
  border-left: var(--lesson__np_button-width) solid color(navbar, 'button');
}

.lesson__button-next-enabled:hover {
  border-left: var(--lesson__np_button-width) solid lighten(color(navbar, 'button'), 20);
}

.lesson__button-next-disabled {
  border-left: var(--lesson__np_button-width) solid darken(color(navbar, 'button'), 40);
}
.lesson__button-next-disabled:hover {
  border-left: var(--lesson__np_button-width) solid darken(color(navbar, 'button'), 40);
}

.lesson__button-prev-enabled {
  border-right: var(--lesson__np_button-width) solid color(navbar, 'button');
}
.lesson__button-prev-enabled:hover {
  border-right: var(--lesson__np_button-width) solid lighten(color(navbar, 'button'), 20);
}

.lesson__button-prev-disabled {
  border-right: var(--lesson__np_button-width) solid darken(color(navbar, 'button'), 40);
}
.lesson__button-prev-disabled:hover {
  border-right: var(--lesson__np_button-width) solid darken(color(navbar, 'button'), 40);
}

.lesson__button-goto_container {
  position: absolute;
  border: 0;
  left: calc(50% - var(--lesson__goto_button-width) / 2);
  top: calc(100% - var(--lesson__np_button-height) / 2 - var(--lesson__goto_button-height) / 2);
  height: var(--lesson__goto_button-height);
  width: var(--lesson__goto_button-width);
}

.lesson__button-goto {
  position: absolute;
  border: 0;
  // left: calc(50% - var(--lesson__goto_button-width) / 2);
  // top: calc(100% - var(--lesson__np_button-height) / 2 - var(--lesson__goto_button-height) / 2);
  background-color: color(navbar, 'button');
  // height: var(--lesson__goto_button-height);
  // width: var(--lesson__goto_button-width);
  font-size: var(--lesson__goto_button-font-size);
  color: color(lesson, 'text');
  width: var(--lesson__goto_button-width);
}

#lesson__button-goto:hover {
  background-color: lighten(color(navbar, 'button'), 10);
}

#lesson__page_number {
  position: absolute;
  width: 100%;
  top: calc(100% - var(--lesson__np_button-height) - var(--lesson__np_button-vspace) / 2 - var(--lesson__goto_button-font-size) / 2);
  font-size: var(--lesson__goto_button-font-size);
  text-align: center;
  color: color(navbar, 'button');
}

@media (min-aspect-ratio: 1/1) {
  :root {
    --lesson__content-width: calc(var(--lesson__container-width) - 2 * var(--lesson__np_button-width) - 2 * var(--lesson__np_button-hspace));
    --lesson__content-height: calc(var(--lesson__content-width) / #{$diagram_ratio});
    --lesson__container-height: var(--lesson__content-height);
    //
    --lesson__max_container-height: 90vh;
    --lesson__max_content-height: var(--lesson__max_container-height);
    --lesson__max_content-width: calc(var(--lesson__max_content-height) * #{$diagram_ratio});
    --lesson__max_container-width: calc(var(--lesson__max_content-width) + 2 * var(--lesson__np_button-width) + 2 * var(--lesson__np_button-hspace));
  }

  .lesson__container {
    width: var(--lesson__container-width);
    height: var(--lesson__container-height);
    margin-left: auto;
    margin-right: auto;
    max-height: var(--lesson__max_container-height);
    max-width: var(--lesson__max_container-width);
  }

  .multipage_diagram {
    display: inline-block;
    width: var(--lesson__content-width);
    height: var(--lesson__content-height);
    margin-left: var(--lesson__np_button-hspace);
    margin-right: var(--lesson__np_button-hspace);
    max-height: var(--lesson__max_content-height);
    max-width: var(--lesson__max_content-width);
  }

  .btn-multi-page-lesson {
    position: relative;
    top: calc(50% - var(--lesson__np_button-height) / 2);
    display: inline-block;
    vertical-align: top;
    border-top: calc(var(--lesson__np_button-height) / 2) solid transparent;
    border-bottom: calc(var(--lesson__np_button-height) / 2) solid transparent;
  }

  .lesson__button-goto_container {
    // left: calc(100% - var(--lesson__np_button-width) / 2 - var(--lesson__goto_button-width) / 2);

    // left: calc(var(--lesson__np_button-width) - var(--lesson__goto_button-width));
    // left: 0;
    top: 105%;
  }

  #lesson__page_number {
    left: calc(50% - var(--lesson__goto_button-width) / 2);
    width: var(--lesson__goto_button-width);
    text-align: center;
    top: calc(110% + var(--lesson__goto_button-font-size) * 2);
    // bottom: 0;
  }
}

.lesson-clear-floats {
  clear: both;
}

.lesson__arrow-right {
  width: 0;
  height: 0;
  border-top: 60px solid transparent;
  border-bottom: 60px solid transparent;
  border-left: 60px solid green;
}

.lesson__padding_override {
  padding: 0;
}

.highlight_word {
  color: color(diagram, 'text-keyword');
  font-style: italic;
}

.action_word {
  font-weight: bold;
}

.action_word_enabled {
  text-decoration: underline;
  cursor: pointer;
}

.latin {
  font-style: italic;
  color: color(diagram, 'text-latin');
}

.greek {
  font-style: italic;
  color: color(diagram, 'text-greek');
}

.english {
  font-style: italic;
  color: color(diagram, 'text-english');
}

.lesson__sub_title {
  padding-top: 0;
  padding-bottom: 0;
  margin-bottom: 0;
  margin-top: 0;
  padding-left: calc(var(--lesson__text-margin) * 0.2);
  margin-left: calc(var(--lesson__text-margin) * 1);
  color: color(diagram, 'disabled');
  font-size: calc(var(--lesson__diagram-font-size) * 0.6);
  font-style: italic;
}
